<div id="alert" style="display: none;">
</div>
<div id="wrapper" class="user">
  <div id="header" class="small">
    <%- form_tag user_search_path(:username => @profile_user.username, :controller => "search") do -%>
      <%= label_tag :query, image_tag("magnifying_glass.png") -%>
      <%= text_field_tag :query, "Search #{@profile_username_possesive} Blogcastr", :onfocus => "if (this.value == 'Search #{@profile_username_possesive_escaped} Blogcastr') this.value = ''; jQuery('#header form').addClass('selected');", :onblur => "if (this.value == '') this.value = 'Search #{@profile_username_possesive_escaped} Blogcastr'; jQuery('#header form').removeClass('selected');" -%>
    <%- end -%>
    <%= link_to(image_tag("/images/logo-small.png", :class => "logo"), "/") %>
    <%= image_tag "/images/beta-small.png", :class => "beta" %>
    <div id="navigation">
<% if @user.instance_of?(BlogcastrUser) -%>
      <%= link_to image_tag(@user.setting.avatar.url(:small)) + @user.username, profile_path(:username => @user.username), :class => "user" %>
      <%= link_to "Home", home_path %>
      <%= link_to "Settings", settings_path %>
      <%= link_to "Sign out", sign_out_path, :method => "delete" %>
<% elsif @user.instance_of?(FacebookUser) -%>
  <%- avatar = @user.get_avatar_url :small %>
  <%- if avatar.nil? -%>
      <%- avatar = get_facebook_avatar_url @user.facebook_id %>
  <%- end -%>
  <%- if avatar.nil? -%>
      <%= link_to image_tag("http://static.ak.facebook.com/pics/q_silhouette_logo.gif") + @user.get_username, @user.get_url, :class => "first" %>
  <%- else -%>
      <%= link_to image_tag(avatar) + @user.get_username, @user.get_url, :class => "first user" %>
  <%- end -%>
      <%= link_to "Sign up", sign_up_path %>
      <span class="button" onclick="FB.Connect.logout(blogcastrFacebookSignOut);">Sign out</span>
<% elsif @user.instance_of?(TwitterUser) -%>
      <%= link_to image_tag(@user.get_avatar_url(:small)) + @user.get_username, @user.get_url, :class => "first user" %>
      <%= link_to "Sign up", sign_up_path %>
      <span onclick="blogcastrTwitterSignOut();">Sign out</span>
<% else -%>
      <%= link_to "Sign up", sign_up_path %>
      <%= link_to "Sign in", sign_in_path %>
<% end -%>
    </div>
    <div class="clear">
    </div>
  </div>
  <div id="content">
    <div id="main">
      <div class="upper-left-border-squared-corner">
      </div>
      <div class="top-border">
      </div>
      <div class="upper-right-border-squared-corner">
      </div>
      <div class="clear">
      </div>
      <div class="background">
        <div id="title">
          <div class="side-border">
            <div class="upper-left-border-squared-corner-gray">
            </div>
            <div class="left-border-gray">
            </div>
            <div class="lower-left-border-squared-corner-gray">
            </div>
          </div>
          <h1 class="image"><%= link_to image_tag(@profile_user.setting.avatar.url(:medium), :class => "avatar"), profile_path(:username => @profile_user.username) -%><%= @profile_user_username_possesive -%> posts</h1>
          <div class="side-border">
            <div class="upper-right-border-squared-corner-gray">
            </div>
            <div class="right-border-gray">
            </div>
            <div class="lower-right-border-squared-corner-gray">
            </div>
          </div>
        </div>
        <h2 class="first"><%= @num_paginated_posts -%> <%= @num_paginated_posts == 1 ? "Post" : "Posts" -%></h2>
<%- if @num_paginated_posts == 0 -%>
        <div class="none">
          <%= @profile_user.username -%> has no posts.
        </div>
<%- else -%>
        <ol class="posts">
  <%- i = @paginated_posts.length -%>
  <%- for post in @paginated_posts -%>
    <%- if post.instance_of?(TextPost) -%>
          <%= render :partial => "/text_posts/text_post", :object => post, :locals => {:i => i - 1, :blogcast => post.blogcast} -%>
    <%- elsif post.instance_of?(ImagePost) -%>
          <%= render :partial => "/image_posts/image_post", :object => post, :locals => {:i => i - 1, :blogcast => post.blogcast} -%>
    <%- elsif post.instance_of?(AudioPost) -%>
          <%= render :partial => "audio_post", :object => post -%>
    <%- elsif post.instance_of?(CommentPost) -%>
          <%= render :partial => "comment_post", :object => post -%>
    <%- elsif post.instance_of?(Repost) -%>
          <%= render :partial => "repost", :object => post -%>
    <%- end -%>
    <%- i = i - 1 -%>
  <%- end -%>
        </ol>
<% end -%>
<% if @num_first_post <= @num_posts -%>
        <div id="paginate">
  <%- if !@previous_page.nil? -%>
          <%= link_to "Back", username_posts_path(:username => @profile_user.username, :page => @previous_page, :id => @id), :class => "back" %>
  <%- end -%>
          <%= @num_first_post -%>-<%= @num_last_post -%> of <%= @num_paginated_posts -%>
  <%- if !@next_page.nil? -%>
          <%= link_to "Next", username_posts_path(:username => @profile_user.username, :page => @next_page, :id => @id), :class => "next" %>
  <%- end -%>
        </div>
<% end -%>
      </div>
      <div class="last lower-left-border-squared-corner">
      </div>
      <div class="last bottom-border">
      </div>
      <div class="last lower-right-border-squared-corner">
      </div>
      <div class="clear">
      </div>
    </div>
    <%= render :partial => "/users/share/side" -%>
    <div class="clear">
    </div>
  </div>
  <div id="footer">
    <span>&copy; 2010 Blogcastr</span>
    <%= link_to "About", about_path -%>
    <a href="http://blogcastr.wordpress.com">Blog</a>
    <a href="http://www.facebook.com/blogcastr">Facebook</a>
    <%= link_to "FAQ", faq_path -%>
    <%= link_to "Privacy Policy", privacy_policy_path -%>
    <%= link_to "Terms of Service", terms_of_service_path -%>
    <a href="http://twitter.com/blogcastr">Twitter</a>
  </div>
</div>
